---
title: Overview, Key Concepts and Objectives
# author: --
# date: last-modified
---

# EVT: Extreme Value Theory

Imagine we have daily observational data for a random variable (e.g., river discharge) for many years. [EVT](https://en.wikipedia.org/wiki/Extreme_value_theory) suggests that the extreme values of this variable are asymptotically close to one of three types of extreme value distributions, regardless of the original distribution of daily observations (see @coles2001). [EVT](https://en.wikipedia.org/wiki/Extreme_value_theory) helps us estimate the probability of rare, high-flow events like floods.

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-height: 5
#| layout-ncol: 3
#| fig-cap: "Illustration of the Extreme Value Theory (EVT)"
#| fig-subcap: 
#|   - "(a) Normal distribution of the random variable"
#|   - "(b) Sampling distribution of the mean"
#|   - "(c) Extreme value distribution (maxima)"

library(ggplot2)
library(lubridate)
library(dplyr)
library(purrr)
library(patchwork)
library(extRemes)

set.seed(123)

# Panel 1: Base normal distribution
x <- rnorm(10000, 0, 1)
df1 <- data.frame(x = x)

# Sampling
N <- 1000
samples <- replicate(N, rnorm(N, 0, 1), simplify = FALSE)
means <- sapply(samples, mean)
maxima <- sapply(samples, max)

df_means <- data.frame(value = means, type = "Mean")

fit_gev = fevd(maxima, method="MLE", type="Gumbel")
loc <- fit_gev$results$par["location"]
scale <- fit_gev$results$par["scale"]
simulated_gumbel <- revd(1000, loc = loc, scale = scale, shape = 0)
df_maxima <- data.frame(value = simulated_gumbel, type = "Max")

# df2 <- rbind(df_means, df_maxima)

# theming
mytheme = function()
{
    theme_minimal(base_size=16) +
    theme(axis.title=element_text(size=16, face="bold"),
          axis.text=element_text(size=16, color="black"))
}

# Panel 1: Normal distribution with overlaid sampling points
p1 <- ggplot(df1, aes(x)) +
  geom_density(fill = "lightblue", alpha = 0.5) +
  geom_point(data = df_means, aes(x = value, y = 0), color = "blue", alpha = 0.5, shape = 17, size = 2) +
  geom_point(data = df_maxima, aes(x = value, y = 0), color = "red", alpha = 0.5, shape = 17, size = 2) +
  labs(x = "x", y = "Density") +
  mytheme()

# Panel 2: Distribution of means
p2 <- ggplot(df_means, aes(x = value)) +
  geom_density(fill = "blue", alpha = 0.5) +
  labs(x = "Mean", y = "Density") +
  xlim(-1, 1) +
  mytheme()
  

# Panel 3: Distribution of maxima
p3 <- ggplot(df_maxima, aes(x = value)) +
  geom_density(fill = "red", alpha = 0.5, adjust = 1) +
  labs(x = "Extreme value (Maxima)", y = "Density") +
  mytheme()

# display plots
p1; p2; p3
```


# EVA: Extreme Value Analysis

::: {.column-margin}
::: {.callout-note}
**EVA** is based on **EVT**
:::
:::

## ðŸŒŠ EVA in Hydrology

EVA is a powerful statistical tool to analyze rare events in hydrology and climate science. It focuses on understanding the frequency and intensity of extreme events.

::: {.column-margin}
::: {.callout-important}
**Independance (absence of autocorrelation)** and **Stationarity** of extreme value time series are the underlying assumptions of EVA.
:::
:::

## ðŸ“Œ Key Concepts of EVA

### ðŸ“ˆ Block Maxima Approach
Selects the maximum value in fixed time blocks (e.g., annual maximum flow or rainfall) â†’ Fits data to distributions like Gumbel or GEV.

### ðŸ“‰ Peak Over Threshold (POT) Method
Considers all events exceeding a predefined threshold â†’ More data points â†’ Fitted to Generalized Pareto Distribution (GPD).

## ðŸŽ¯ Objectives of EVA

ðŸ” **Estimate Return Periods**: Assess the intensity of rare events expected to be exceeded, on average, once every N years (e.g., for example, a 100-year event corresponds to a 1% annual probability of being exceeded).

ðŸ“Š **Construct Frequency Curves**: Fit statistical distributions (e.g., GEV, Gumbel, Log-Pearson Type III) to observed extremes to relate event magnitude to exceedance probability.

ðŸ§° **Support Risk-Based Design**: Inform engineering design criteria (e.g., for dams, levees, drainage systems) based on scientifically justified extreme thresholds

## ðŸ—ï¸ Real-world Applications of EVA

ðŸžï¸ **Infrastructure Design:** Design dams, bridges, culverts based on expected extreme flows.

ðŸ’§ **Water Resource Management:** Plan for droughts, reservoir operations, and sustainable use.

âš ï¸ **Risk Assessment & Planning:** Develop floodplain zoning, disaster risk reduction strategies.

ðŸ§­ **Policy & Climate Adaptation:** Inform government strategies and early warning systems in a changing climate.

# Practical Objectives of this Module

ðŸ“Š **Apply sampling approaches for extreme events**

Use annual maxima and peaks-over-threshold (POT) methods, including threshold selection and declustering to identify independent events.

ðŸ“ˆ **Understand trend detection in extreme streamflow series**

Gain insight into statistical methods for identifying trends in hydrometeorological extremes.

ðŸ§ª **Compare non-parametric and parametric techniques**

Implement and contrast the non-parametric test (e.g., Mann-Kendall) with parametric (distribution-based) models such as Generalized Extreme Value Distribution (GEV) and Generalized Pareto Distribution (GPD) in a non-stationary framework.

ðŸ” **Interpret statistical significance**

Evaluate the reliability and meaning of trend detection results under various statistical assumptions.

ðŸ’» **Use open-source R packages for implementation**

Apply all methods in practice using reproducible, open-source tools within the [R environment](https://www.r-project.org/).



# References


::: {#refs}
:::